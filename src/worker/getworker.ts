// eslint-disable-next-line quotes
const workerCode = `function(e){"use strict";var w=n,t=n;function n(e,t,n){n=n||2;var r,i,o,a,v,h,l,u=t&&t.length,x=u?t[0]*n:e.length,f=p(e,0,x,n,!0),s=[];if(!f||f.next===f.prev)return s;if(u&&(f=function(e,t,n,r){var i,o,a,v,h,l=[];for(i=0,o=t.length;i<o;i++)a=t[i]*r,v=i<o-1?t[i+1]*r:e.length,(h=p(e,a,v,r,!1))===h.next&&(h.steiner=!0),l.push(function(e){var t=e,n=e;for(;(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next,t!==e;);return n}(h));for(l.sort(y),i=0;i<l.length;i++)!function(e,t){{var n;(t=function(e,t){var n,r=t,i=e.x,o=e.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var v=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(v<=i&&a<v){if((a=v)===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===a)return n;var h,l=n,u=n.x,x=n.y,f=1/0;r=n;for(;i>=r.x&&r.x>=u&&i!==r.x&&M(o<x?i:a,o,u,x,o<x?a:i,o,r.x,r.y)&&(h=Math.abs(o-r.y)/(i-r.x),Z(r,e)&&(h<f||h===f&&(r.x>n.x||r.x===n.x&&function(e,t){return b(e.prev,e,t.prev)<0&&b(t.next,e,e.next)<0}(n,r)))&&(n=r,f=h)),r=r.next,r!==l;);return n}(e,t))&&(n=S(t,e),g(t,t.next),g(n,n.next))}}(l[i],n),n=g(n,n.next);return n}(e,t,f,n)),e.length>80*n){r=o=e[0],i=a=e[1];for(var c=n;c<x;c+=n)(v=e[c])<r&&(r=v),(h=e[c+1])<i&&(i=h),o<v&&(o=v),a<h&&(a=h);l=0!==(l=Math.max(o-r,a-i))?1/l:0}return d(f,s,n,r,i,l),s}function p(e,t,n,r,i){var o,a;if(i===0<z(e,t,n,r))for(o=t;o<n;o+=r)a=v(o,e[o],e[o+1],a);else for(o=n-r;t<=o;o-=r)a=v(o,e[o],e[o+1],a);return a&&u(a,a.next)&&(f(a),a=a.next),a}function g(e,t){if(!e)return e;t=t||e;var n,r=e;do{if(n=!1,r.steiner||!u(r,r.next)&&0!==b(r.prev,r,r.next))r=r.next;else{if(f(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function d(e,t,n,r,i,o,a){if(e){!a&&o&&function(e,t,n,r){var i=e;for(;null===i.z&&(i.z=m(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next,i!==e;);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,o,a,v,h,l=1;do{for(n=e,o=e=null,a=0;n;){for(a++,r=n,t=v=0;t<l&&(v++,r=r.nextZ);t++);for(h=l;0<v||0<h&&r;)0!==v&&(0===h||!r||n.z<=r.z)?(n=(i=n).nextZ,v--):(r=(i=r).nextZ,h--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;n=r}o.nextZ=null,l*=2}while(1<a)}(i)}(e,r,i,o);for(var v,h,l=e;e.prev!==e.next;)if(v=e.prev,h=e.next,o?function(e,t,n,r){var i=e.prev,o=e,a=e.next;if(0<=b(i,o,a))return!1;var v=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,h=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,l=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,u=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,x=m(v,h,t,n,r),f=m(l,u,t,n,r),s=e.prevZ,c=e.nextZ;for(;s&&s.z>=x&&c&&c.z<=f;){if(s!==e.prev&&s!==e.next&&M(i.x,i.y,o.x,o.y,a.x,a.y,s.x,s.y)&&0<=b(s.prev,s,s.next))return!1;if(s=s.prevZ,c!==e.prev&&c!==e.next&&M(i.x,i.y,o.x,o.y,a.x,a.y,c.x,c.y)&&0<=b(c.prev,c,c.next))return!1;c=c.nextZ}for(;s&&s.z>=x;){if(s!==e.prev&&s!==e.next&&M(i.x,i.y,o.x,o.y,a.x,a.y,s.x,s.y)&&0<=b(s.prev,s,s.next))return!1;s=s.prevZ}for(;c&&c.z<=f;){if(c!==e.prev&&c!==e.next&&M(i.x,i.y,o.x,o.y,a.x,a.y,c.x,c.y)&&0<=b(c.prev,c,c.next))return!1;c=c.nextZ}return!0}(e,r,i,o):function(e){var t=e.prev,n=e,r=e.next;if(0<=b(t,n,r))return!1;var i=e.next.next;for(;i!==e.prev;){if(M(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&0<=b(i.prev,i,i.next))return!1;i=i.next}return!0}(e))t.push(v.i/n),t.push(e.i/n),t.push(h.i/n),f(e),e=h.next,l=h.next;else if((e=h)===l){a?1===a?d(e=function(e,t,n){var r=e;do{var i=r.prev,o=r.next.next;!u(i,o)&&x(i,r,r.next,o)&&Z(i,o)&&Z(o,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(o.i/n),f(r),f(r.next),r=e=o),r=r.next}while(r!==e);return g(r)}(g(e),t,n),t,n,r,i,o,2):2===a&&function(e,t,n,r,i,o){var a=e;do{for(var v=a.next.next;v!==a.prev;){if(a.i!==v.i&&function(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&x(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(Z(e,t)&&Z(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;for(;n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next,n!==e;);return r}(e,t)&&(b(e.prev,e,t.prev)||b(e,t.prev,t))||u(e,t)&&0<b(e.prev,e,e.next)&&0<b(t.prev,t,t.next))}(a,v)){var h=S(a,v);return a=g(a,a.next),h=g(h,h.next),d(a,t,n,r,i,o),d(h,t,n,r,i,o)}v=v.next}a=a.next}while(a!==e)}(e,t,n,r,i,o):d(g(e),t,n,r,i,o,1);break}}}function y(e,t){return e.x-t.x}function m(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function M(e,t,n,r,i,o,a,v){return 0<=(i-a)*(t-v)-(e-a)*(o-v)&&0<=(e-a)*(r-v)-(n-a)*(t-v)&&0<=(n-a)*(o-v)-(i-a)*(r-v)}function b(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function u(e,t){return e.x===t.x&&e.y===t.y}function x(e,t,n,r){var i=l(b(e,t,n)),o=l(b(e,t,r)),a=l(b(n,r,e)),v=l(b(n,r,t));return i!==o&&a!==v||(0===i&&h(e,n,t)||(0===o&&h(e,r,t)||(0===a&&h(n,e,r)||!(0!==v||!h(n,t,r)))))}function h(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function l(e){return 0<e?1:e<0?-1:0}function Z(e,t){return b(e.prev,e,e.next)<0?0<=b(e,t,e.next)&&0<=b(e,e.prev,t):b(e,t,e.prev)<0||b(e,e.next,t)<0}function S(e,t){var n=new a(e.i,e.x,e.y),r=new a(t.i,t.x,t.y),i=e.next,o=t.prev;return(e.next=t).prev=e,(n.next=i).prev=n,(r.next=n).prev=r,(o.next=r).prev=o,r}function v(e,t,n,r){var i=new a(e,t,n);return r?(i.next=r.next,(i.prev=r).next.prev=i,r.next=i):(i.prev=i).next=i,i}function f(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function a(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function z(e,t,n,r){for(var i=0,o=t,a=n-r;o<n;o+=r)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}function i(e,t){var n=e.length-1,r=[e[0]];return function e(t,n,r,i,o){for(var a,v,h,l,u,x,f,s,c,p=i,g=n+1;g<r;g++){var d=(v=t[g],h=t[n],l=t[r],c=s=f=x=u=void 0,x=h[0],f=h[1],s=l[0]-x,c=l[1]-f,0===s&&0===c||(1<(u=((v[0]-x)*s+(v[1]-f)*c)/(s*s+c*c))?(x=l[0],f=l[1]):0<u&&(x+=s*u,f+=c*u)),(s=v[0]-x)*s+(c=v[1]-f)*c);p<d&&(a=g,p=d)}i<p&&(1<a-n&&e(t,n,a,i,o),o.push(t[a]),1<r-a&&e(t,a,r,i,o))}(e,0,n,t,r),r.push(e[n]),r}function A(e,t,n){if(e.length<=2)return e;var r=void 0!==t?t*t:1;return e=i(e=n?e:function(e,t){for(var n,r,i,o,a,v=e[0],h=[v],l=1,u=e.length;l<u;l++)n=e[l],i=v,a=o=void 0,o=(r=n)[0]-i[0],a=r[1]-i[1],t<o*o+a*a&&(h.push(n),v=n);return v!==n&&h.push(n),h}(e,r),r)}function O(e,t){var n=t[0],r=t[1],i=Math.sqrt(n*n+r*r);return e[0]=n/i,e[1]=r/i,e}function R(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}function L(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}n.deviation=function(e,t,n,r){var i=t&&t.length,o=i?t[0]*n:e.length,a=Math.abs(z(e,0,o,n));if(i)for(var v=0,h=t.length;v<h;v++){var l=t[v]*n,u=v<h-1?t[v+1]*n:e.length;a-=Math.abs(z(e,l,u,n))}for(var x=0,v=0;v<r.length;v+=3){var f=r[v]*n,s=r[v+1]*n,c=r[v+2]*n;x+=Math.abs((e[f]-e[c])*(e[1+s]-e[1+f])-(e[f]-e[s])*(e[1+c]-e[1+f]))}return 0===a&&0===x?0:Math.abs((x-a)/a)},n.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++)for(var a=0;a<t;a++)n.vertices.push(e[i][o][a]);0<i&&(r+=e[i-1].length,n.holes.push(r))}return n},w.default=t;var q=[];function ue(e,t,n,r){var i,o,a,v,h,l,u,x,f,s,c,p=(o=n,(i=t)[0]*o[0]+i[1]*o[1]+i[2]*o[2]),g=Math.acos(p)*r;return R(q,n,t,-p),h=(v=a=q)[0],l=v[1],u=v[2],x=Math.sqrt(h*h+l*l+u*u),a[0]=h/x,a[1]=l/x,a[2]=u/x,f=e,s=t,c=Math.cos(g),f[0]=s[0]*c,f[1]=s[1]*c,f[2]=s[2]*c,R(e,e,q,Math.sin(g)),e}function F(e,t,n){if(n-t<3)return 0;for(var r=0,i=2*(n-1),o=2*t;o<2*n;){var a=e[i],v=e[i+1],h=e[o],l=e[o+1],i=o;o+=2,r+=a*l-h*v}return r}var P=[],V=[],W=[];function B(e,t,n,r,i,o,a,v){var h=null!=a,l=i,u=null;h&&(u=new Uint32Array(r-n));for(var x,f,s,c,p,g=n;g<r;g++){var d,y,m,M,b,w,Z,S,z=g===r-1?n:g+1,A=g===n?r-1:g-1,R=e[2*A],q=e[2*A+1],F=e[2*g],B=e[2*g+1],U=e[2*z],L=e[2*z+1];P[0]=F-R,P[1]=B-q,V[0]=U-F,V[1]=L-B,O(P,P),O(V,V),h&&(u[g]=l),v||g!==n?v||g!==r-1?(c=V,p=P,(s=W)[0]=c[0]+p[0],s[1]=c[1]+p[1],d=W[1],W[1]=-W[0],W[0]=d,O(W,W),f=V,y=(x=W)[0]*f[0]+x[1]*f[1],m=Math.sqrt(1-y*y),M=o*Math.min(10,1/m),h&&a<1/m&&o*y<0?(b=F+W[0]*o,w=B+W[1]*o,Z=Math.acos(m)/2,S=Math.tan(Z)*Math.abs(o),t[2*l]=b+W[1]*S,t[2*l+1]=w-W[0]*S,t[2*++l]=b-W[1]*S,t[2*l+1]=w+W[0]*S):(t[2*l]=F+W[0]*M,t[2*l+1]=B+W[1]*M)):(W[0]=P[1],W[1]=-P[0],O(W,W),t[2*l]=F+W[0]*o,t[2*l+1]=B+W[1]*o):(W[0]=V[1],W[1]=-V[0],O(W,W),t[2*l]=F+W[0]*o,t[2*l+1]=B+W[1]*o),l++}return u}function U(e,t,n,r,i){var o=null!=r?[]:new Float32Array(e.length);if(B(e,o,0,t&&t.length?t[0]:e.length/2,0,n,r,i),t)for(var a=0;a<t.length;a++){var v=t[a];B(e,o,v,t[a+1]||e.length/2,null!=r?o.length/2:v,n,r,i)}return o}function j(e,t,n,r){for(var i=0;i<Math.floor((r-n)/2);i++)for(var o=0;o<t;o++){var a=(i+n)*t+o,v=(r-i-1)*t+o,h=e[a];e[a]=e[v],e[v]=h}return e}function k(e){e.depth=e.depth||1,e.bevelSize=e.bevelSize||0,e.bevelSegments=null==e.bevelSegments?2:e.bevelSegments,e.smoothSide=e.smoothSide||!1,e.smoothBevel=e.smoothBevel||!1,e.simplify=e.simplify||0,"number"==typeof e.depth&&(e.bevelSize=Math.min(0<e.bevelSegments?e.bevelSize:0,e.depth/2)),0<e.bevelSize||(e.bevelSegments=0),e.bevelSegments=Math.round(e.bevelSegments);var t,n,r,i,o=e.boundingRect;e.translate=e.translate||[0,0],e.scale=e.scale||[1,1],e.fitRect&&(t=null==e.fitRect.x?o.x||0:e.fitRect.x,n=null==e.fitRect.y?o.y||0:e.fitRect.y,r=e.fitRect.width,i=e.fitRect.height,null==r?null!=i?r=i/o.height*o.width:(r=o.width,i=o.height):null==i&&(i=r/o.width*o.height),e.scale=[r/o.width,i/o.height],e.translate=[(t-o.x)*e.scale[0],(n-o.y)*e.scale[1]])}function I(e,t){function n(e,t,n,r){e[0]=t,e[1]=n,e[2]=r}for(var r,i,o,a,v,h,l,u,x,f=[],s=[],c=[],p=[],g=[],d=[],y=e.length,m=new Float32Array(t.length),M=0;M<y;){var b=3*e[M++],w=3*e[M++],Z=3*e[M++];n(f,t[b],t[1+b],t[2+b]),n(s,t[w],t[1+w],t[2+w]),n(c,t[Z],t[1+Z],t[2+Z]),L(p,f,s),L(g,s,c),r=d,o=g,x=u=l=h=v=a=void 0,a=(i=p)[0],v=i[1],h=i[2],l=o[0],u=o[1],x=o[2],r[0]=v*x-h*u,r[1]=h*l-a*x,r[2]=a*u-v*l;for(var S=0;S<3;S++)m[b+S]=m[b+S]+d[S],m[w+S]=m[w+S]+d[S],m[Z+S]=m[Z+S]+d[S]}for(var z,A,R,q,F,B,U=0;U<m.length;)n(d,m[U],m[U+1],m[U+2]),B=F=q=R=void 0,R=(A=z=d)[0],q=A[1],F=A[2],B=Math.sqrt(R*R+q*q+F*F),z[0]=R/B,z[1]=q/B,z[2]=F/B,m[U++]=d[0],m[U++]=d[1],m[U++]=d[2];return m}var xe=[[0,0],[1,0],[1,1],[0,0],[1,1],[0,1]];function _(e,t,n,r,i,o){var a=t.vertices,v=t.topVertices,h=t.depth,l=t.rect,u=r-n,x=o.smoothSide?1:2,f=u*x,s=o.smoothBevel?1:2,c=Math.min(h/2,o.bevelSize),p=o.bevelSegments,g=i.vertex,d=Math.max(l.width,l.height,h);if(0<c)for(var y=[0,0,1],m=[],M=[0,0,-1],b=[],w=0,Z=new Float32Array(u),S=0;S<2;S++)for(var z=0===S?h-c:c,A=0;A<=p*s;A++){for(var R=0,q=void 0,F=void 0,B=0;B<u;B++){for(var U=0;U<x;U++){var L=2*((B+U)%u+n);m[0]=a[L]-v[L],m[1]=a[1+L]-v[1+L],m[2]=0;var O=Math.sqrt(m[0]*m[0]+m[1]*m[1]);m[0]/=O,m[1]/=O;var P=(Math.floor(A/s)+A%s)/p;0===S?ue(b,y,m,P):ue(b,m,M,P);var V,W,j,k,I=0===S?P:1-P,_=c*Math.sin(I*Math.PI/2),D=O*Math.cos(I*Math.PI/2),E=c*O/Math.sqrt(_*_+D*D),C=b[0]*E+v[L],G=b[1]*E+v[1+L],H=b[2]*E+z;e.position[3*i.vertex]=C,e.position[3*i.vertex+1]=G,e.position[3*i.vertex+2]=H,(0<B||0<U)&&(R+=Math.sqrt((q-C)*(q-C)+(F-G)*(F-G))),(0<A||0<S)&&(V=3*(i.vertex-f),W=e.position[V],j=e.position[1+V],k=e.position[2+V],Z[B]+=Math.sqrt((W-C)*(W-C)+(j-G)*(j-G)+(k-H)*(k-H))),e.uv[2*i.vertex]=R/d,e.uv[2*i.vertex+1]=Z[B]/d,q=C,F=G,i.vertex++}if(1<s&&A%s||1==s&&1<=A)for(var J=0;J<6;J++){var K=(xe[J][0]+B*x)%f,N=xe[J][1]+w;e.indices[i.index++]=(N-1)*f+K+g}}w++}else for(var Q=0;Q<2;Q++)for(var T=0===Q?h-c:c,X=0,Y=void 0,$=void 0,ee=0;ee<u;ee++)for(var te=0;te<x;te++){var ne=2*((ee+te)%u+n),re=a[ne],ie=a[1+ne];e.position[3*i.vertex]=re,e.position[3*i.vertex+1]=ie,e.position[3*i.vertex+2]=T,(0<ee||0<te)&&(X+=Math.sqrt((Y-re)*(Y-re)+($-ie)*($-ie))),e.uv[2*i.vertex]=X/d,e.uv[2*i.vertex+1]=T/d,Y=re,$=ie,i.vertex++}for(var oe=0<c?p*s+1:1,ae=0;ae<u;ae++)for(var ve=0;ve<6;ve++){var he=(xe[ve][0]+ae*x)%f,le=xe[ve][1]+oe;e.indices[i.index++]=(le-1)*f+he+g}}function D(e,t){for(var n=0,r=0,i=0;i<e.length;i++){var o=e[i],a=o.indices,v=o.vertices,h=o.holes,l=o.depth,u=v.length/2,x=0<Math.min(l/2,t.bevelSize)?t.bevelSegments:0;n+=a.length*(t.excludeBottom?1:2),r+=u*(t.excludeBottom?1:2);for(var f=2+2*x,s=0,c=0,p=0;p<(h?h.length:0)+1;p++){n+=6*((c=0===p?h&&h.length?h[0]:u:(s=h[p-1],h[p]||u))-s)*(f-1);var g=(c-s)*(t.smoothSide?1:2);r+=g*f+(t.smoothBevel?0:x*g*2)}}for(var d={position:new Float32Array(3*r),indices:new(65535<r?Uint32Array:Uint16Array)(n),uv:new Float32Array(2*r)},y={vertex:0,index:0},m=0;m<e.length;m++)!function(e,t,n,r){var i=e.indices,o=e.vertices,a=e.topVertices,v=e.rect,h=e.depth;if(!(o.length<=4)){for(var l=n.vertex,u=i.length,x=0;x<u;x++)t.indices[n.index++]=l+i[x];for(var f=Math.max(v.width,v.height),s=0;s<(r.excludeBottom?1:2);s++)for(var c=0;c<a.length;c+=2){var p=a[c],g=a[c+1];t.position[3*n.vertex]=p,t.position[3*n.vertex+1]=g,t.position[3*n.vertex+2]=(1-s)*h,t.uv[2*n.vertex]=(p-v.x)/f,t.uv[2*n.vertex+1]=(g-v.y)/f,n.vertex++}if(!r.excludeBottom)for(var d=o.length/2,y=0;y<u;y+=3)for(var m=0;m<3;m++)t.indices[n.index++]=l+d+i[y+2-m]}}(e[m],d,y,t);for(var M=0;M<e.length;M++){var b,w=e[M],Z=w.holes,S=w.vertices.length/2,z=Z&&Z.length?Z[0]:S;if(_(d,e[M],0,z,y,t),Z)for(var A=0;A<Z.length;A++)b=Z[A],z=Z[A+1]||S,_(d,e[M],b,z,y,t)}for(var R=0;R<d.uv.length;R++){var q=d.uv[R];0<q&&Math.round(q)===q?d.uv[R]=1:d.uv[R]=q%1}return d.normal=I(d.indices,d.position),d.boundingRect=e[0]&&e[0].rect,d}function E(e,t){t=Object.assign({},t);for(var n=[1/0,1/0],r=[-1/0,-1/0],i=0;i<e.length;i++)G(e[i][0],n,r);t.boundingRect=t.boundingRect||{x:n[0],y:n[1],width:r[0]-n[0],height:r[1]-n[1]},k(t);for(var o,a=[],v=t.translate||[0,0],h=t.scale||[1,1],l=t.boundingRect,u={x:l.x*h[0]+v[0],y:l.y*h[1]+v[1],width:l.width*h[0],height:l.height*h[1]},x=Math.min(l.width,l.height)/1e5,f=0;f<e.length;f++){var s=function(e,t){for(var n=[],r=0;r<e.length;r++){for(var i=e[r],o=[],a=i.length,v=i[a-1][0],h=i[a-1][1],l=0,u=0;u<a;u++){var x=i[u][0],f=i[u][1],s=x-v,c=f-h;t<(l+=Math.sqrt(s*s+c*c))&&(o.push(i[u]),l=0),v=x,h=f}3<=o.length&&n.push(o)}return 0<n.length?n:null}(e[f],x);if(s){var c=t.simplify/Math.max(h[0],h[1]);if(0<c&&(s=function(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r];3<=(i=A(i,t,!0)).length&&n.push(i)}return 0<n.length?n:null}(s,c)),s){for(var p=w.flatten(s),g=p.vertices,d=p.holes,y=p.dimensions,m=0;m<g.length;)g[m]=g[m++]*h[0]+v[0],g[m]=g[m++]*h[1]+v[1];if(!function(e,t){var n=e.length/2,r=0,i=t&&t.length?t[0]:n;0<F(e,r,i)&&j(e,2,r,i);for(var o=1;o<(t?t.length:0)+1;o++)F(e,r=t[o-1],i=t[o]||n)<0&&j(e,2,r,i)}(g,d),2!==y)throw new Error("Only 2D polygon points are supported");var M=0<t.bevelSize?U(g,d,t.bevelSize,null,!0):g,b=(void 0===(o=y)&&(o=2),w(M,d,o));a.push({indices:b,vertices:g,topVertices:M,holes:d,rect:u,depth:"function"==typeof t.depth?t.depth(f):t.depth})}}}return D(a,t)}function C(e,t){t=Object.assign({},t);for(var n=[1/0,1/0],r=[-1/0,-1/0],i=0;i<e.length;i++)G(e[i],n,r);t.boundingRect=t.boundingRect||{x:n[0],y:n[1],width:r[0]-n[0],height:r[1]-n[1]},k(t);var o=t.scale||[1,1];null==t.lineWidth&&(t.lineWidth=1),null==t.miterLimit&&(t.miterLimit=2);for(var a=[],v=0;v<e.length;v++){var h=e[v],l=t.simplify/Math.max(o[0],o[1]);0<l&&(h=A(h,l,!0)),a.push(function(e,t,n){for(var r=n.lineWidth,i=e.length,o=new Float32Array(2*i),a=n.translate||[0,0],v=n.scale||[1,1],h=0,l=0;h<i;h++)o[l++]=e[h][0]*v[0]+a[0],o[l++]=e[h][1]*v[1]+a[1];F(o,0,i)<0&&j(o,2,0,i);var u=[],x=[],f=n.miterLimit,s=B(o,x,0,i,0,-r/2,f,!1);j(o,2,0,i);for(var c=B(o,u,0,i,0,-r/2,f,!1),p=(u.length+x.length)/2,g=new Float32Array(2*p),d=0,y=x.length/2,m=0;m<x.length;m++)g[d++]=x[m];for(var M=0;M<u.length;M++)g[d++]=u[M];for(var b=new(65535<p?Uint32Array:Uint16Array)(3*(2*(i-1)+(p-2*i))),w=0,Z=0;Z<i-1;Z++){var S=Z+1;b[w++]=y-1-s[Z],b[w++]=y-1-s[Z]-1,b[w++]=c[Z]+1+y,b[w++]=y-1-s[Z],b[w++]=c[Z]+1+y,b[w++]=c[Z]+y,c[S]-c[Z]==2?(b[w++]=c[Z]+2+y,b[w++]=c[Z]+1+y,b[w++]=y-s[S]-1):s[S]-s[Z]==2&&(b[w++]=c[S]+y,b[w++]=y-1-(s[Z]+1),b[w++]=y-1-(s[Z]+2))}var z=0<n.bevelSize?U(g,[],n.bevelSize,null,!0):g,A=n.boundingRect;return{vertices:g,indices:b,topVertices:z,rect:{x:A.x*v[0]+a[0],y:A.y*v[1]+a[1],width:A.width*v[0],height:A.height*v[1]},depth:"function"==typeof n.depth?n.depth(t):n.depth,holes:[]}}(h,v,t))}return D(a,t)}function G(e,t,n){for(var r=0;r<e.length;r++)t[0]=Math.min(e[r][0],t[0]),t[1]=Math.min(e[r][1],t[1]),n[0]=Math.max(e[r][0],n[0]),n[1]=Math.max(e[r][1],n[1])}function s(e){for(var t=new Float32Array(e),n=[],r=0,i=t.length;r<i;r+=2){var o=t[r],a=t[r+1];n.push([o,a])}return n}function c(e,t){void 0===t&&(t=!1);for(var n,r,i,o,a,v,h,l,u,x,f,s,c=e.length,p=[],g=[],d=[],y=0,m=0,M=0,b=0,w=0;w<c;w++){var Z=t?(u=e[w],s=f=x=void 0,x=u.data,f=u.height,s=u.width,C(x,{lineWidth:s,depth:f})):(n=e[w],l=h=v=a=o=i=r=void 0,r=n.data,i=n.height,o=E(r,{depth:i}),a=o.position,v=o.normal,h=o.uv,l=o.indices,{position:a,normal:v,uv:h,indices:l}),S=Z.position,z=Z.normal,A=Z.uv,R=Z.indices;g.push(Z);var q=R.length/3;d[w]=[y+1,y+q],y+=q;var F=S.length/3,B=z.length/3,U=A.length/2;p[w]={position:{count:F,start:m,end:m+3*F},normal:{count:B,start:M,end:M+3*B},uv:{count:U,start:b,end:b+2*U},hide:!1},m+=3*F,M+=3*B,b+=2*U}var L=function(e){for(var t={},n={},r=0;r<e.length;++r){var i=e[r];for(var o in i)void 0===t[o]&&(t[o]=[],n[o]=0),t[o].push(i[o]),n[o]+=i[o].length}var a={},v=0,h=[];for(var l in t)if("indices"===l)for(var u=t[l],x=0,f=u.length;x<f;x++){for(var s=u[x],c=0,p=s.length;c<p;c++)h.push(s[c]+v);v+=t.position[x].length/3}else{var g=function(e,t){for(var n=new Float32Array(t),r=0,i=0;i<e.length;++i)n.set(e[i],r),r+=e[i].length;return n}(t[l],n[l]);if(!g)return null;a[l]=g}return a.indices=new Uint32Array(h),a}(g),O=L.position,P=L.normal,V=L.uv,W=L.indices;return{position:O.buffer,normal:P.buffer,uv:V.buffer,indices:W.buffer,faceMap:d,geometriesAttributes:p}}e.initialize=function(){},e.onmessage=function(e,t){var n=e.data,r=n.type,i=n.datas;if("Polygon"===r){!function(e){for(var t=e.length,n=0;n<t;n++)for(var r=e[n].data,i=0,o=r.length;i<o;i++)for(var a=r[i],v=0,h=a.length;v<h;v++)e[n].data[i][v]=s(a[v])}(i);var o=c(i);t(null,o,[o.position,o.normal,o.uv,o.indices])}else if("LineString"===r){for(var a=0,v=i.length;a<v;a++)for(var h=0,l=i[a].data.length;h<l;h++)i[a].data[h]=s(i[a].data[h]);var u=c(i,!0);t(null,u,[u.position,u.normal,u.uv,u.indices])}},Object.defineProperty(e,"__esModule",{value:!0})}`;
const workerName = '__maptalks.three';

export function getWorkerName() {
    return workerName;
}

export function getWorkerCode() {
    return workerCode;
}
