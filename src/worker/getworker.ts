// eslint-disable-next-line quotes
const workerCode = `(function(e){"use strict";var t=r,n=r;function r(e,t,n){n=n||2;var r,v,u,h,l,s,c,g=t&&t.length,d=g?t[0]*n:e.length,y=i(e,0,d,n,!0),m=[];if(!y||y.next===y.prev)return m;if(g&&(y=function(e,t,n,r){var a,v,u,h=[];for(a=0,v=t.length;a<v;a++)(u=i(e,t[a]*r,a<v-1?t[a+1]*r:e.length,r,!1))===u.next&&(u.steiner=!0),h.push(p(u));for(h.sort(x),a=0;a<h.length;a++)f(h[a],n),n=o(n,n.next);return n}(e,t,y,n)),e.length>80*n){r=u=e[0],v=h=e[1];for(var M=n;M<d;M+=n)(l=e[M])<r&&(r=l),(s=e[M+1])<v&&(v=s),l>u&&(u=l),s>h&&(h=s);c=0!==(c=Math.max(u-r,h-v))?1/c:0}return a(y,m,n,r,v,c),m}function i(e,t,n,r,i){var o,a;if(i===q(e,t,n,r)>0)for(o=t;o<n;o+=r)a=z(o,e[o],e[o+1],a);else for(o=n-r;o>=t;o-=r)a=z(o,e[o],e[o+1],a);return a&&m(a,a.next)&&(A(a),a=a.next),a}function o(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!m(r,r.next)&&0!==y(r.prev,r,r.next))r=r.next;else{if(A(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function a(e,t,n,r,i,x,f){if(e){!f&&x&&function(e,t,n,r){var i=e;do{null===i.z&&(i.z=c(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,o,a,v,u,h=1;do{for(n=e,e=null,o=null,a=0;n;){for(a++,r=n,v=0,t=0;t<h&&(v++,r=r.nextZ);t++);for(u=h;v>0||u>0&&r;)0!==v&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,v--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;n=r}o.nextZ=null,h*=2}while(a>1)}(i)}(e,r,i,x);for(var s,p,g=e;e.prev!==e.next;)if(s=e.prev,p=e.next,x?u(e,r,i,x):v(e))t.push(s.i/n),t.push(e.i/n),t.push(p.i/n),A(e),e=p.next,g=p.next;else if((e=p)===g){f?1===f?a(e=h(o(e),t,n),t,n,r,i,x,2):2===f&&l(e,t,n,r,i,x):a(o(e),t,n,r,i,x,1);break}}}function v(e){var t=e.prev,n=e,r=e.next;if(y(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(g(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&y(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function u(e,t,n,r){var i=e.prev,o=e,a=e.next;if(y(i,o,a)>=0)return!1;for(var v=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,h=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,x=c(v,u,t,n,r),f=c(h,l,t,n,r),s=e.prevZ,p=e.nextZ;s&&s.z>=x&&p&&p.z<=f;){if(s!==e.prev&&s!==e.next&&g(i.x,i.y,o.x,o.y,a.x,a.y,s.x,s.y)&&y(s.prev,s,s.next)>=0)return!1;if(s=s.prevZ,p!==e.prev&&p!==e.next&&g(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&y(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;s&&s.z>=x;){if(s!==e.prev&&s!==e.next&&g(i.x,i.y,o.x,o.y,a.x,a.y,s.x,s.y)&&y(s.prev,s,s.next)>=0)return!1;s=s.prevZ}for(;p&&p.z<=f;){if(p!==e.prev&&p!==e.next&&g(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&y(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function h(e,t,n){var r=e;do{var i=r.prev,a=r.next.next;!m(i,a)&&M(i,r,r.next,a)&&Z(i,a)&&Z(a,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(a.i/n),A(r),A(r.next),r=e=a),r=r.next}while(r!==e);return o(r)}function l(e,t,n,r,i,v){var u=e;do{for(var h=u.next.next;h!==u.prev;){if(u.i!==h.i&&d(u,h)){var l=S(u,h);return u=o(u,u.next),l=o(l,l.next),a(u,t,n,r,i,v),void a(l,t,n,r,i,v)}h=h.next}u=u.next}while(u!==e)}function x(e,t){return e.x-t.x}function f(e,t){if(t=function(e,t){var n,r=t,i=e.x,o=e.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var v=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(v<=i&&v>a){if(a=v,v===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===a)return n;var u,h=n,l=n.x,x=n.y,f=1/0;r=n;do{i>=r.x&&r.x>=l&&i!==r.x&&g(o<x?i:a,o,l,x,o<x?a:i,o,r.x,r.y)&&(u=Math.abs(o-r.y)/(i-r.x),Z(r,e)&&(u<f||u===f&&(r.x>n.x||r.x===n.x&&s(n,r)))&&(n=r,f=u)),r=r.next}while(r!==h);return n}(e,t)){var n=S(t,e);o(t,t.next),o(n,n.next)}}function s(e,t){return y(e.prev,e,t.prev)<0&&y(t.next,e,e.next)<0}function c(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function p(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function g(e,t,n,r,i,o,a,v){return(i-a)*(t-v)-(e-a)*(o-v)>=0&&(e-a)*(r-v)-(n-a)*(t-v)>=0&&(n-a)*(o-v)-(i-a)*(r-v)>=0}function d(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&M(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(Z(e,t)&&Z(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(y(e.prev,e,t.prev)||y(e,t.prev,t))||m(e,t)&&y(e.prev,e,e.next)>0&&y(t.prev,t,t.next)>0)}function y(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function m(e,t){return e.x===t.x&&e.y===t.y}function M(e,t,n,r){var i=w(y(e,t,n)),o=w(y(e,t,r)),a=w(y(n,r,e)),v=w(y(n,r,t));return i!==o&&a!==v||(!(0!==i||!b(e,n,t))||(!(0!==o||!b(e,r,t))||(!(0!==a||!b(n,e,r))||!(0!==v||!b(n,t,r)))))}function b(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function w(e){return e>0?1:e<0?-1:0}function Z(e,t){return y(e.prev,e,e.next)<0?y(e,t,e.next)>=0&&y(e,e.prev,t)>=0:y(e,t,e.prev)<0||y(e,e.next,t)<0}function S(e,t){var n=new R(e.i,e.x,e.y),r=new R(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function z(e,t,n,r){var i=new R(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function A(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function R(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function q(e,t,n,r){for(var i=0,o=t,a=n-r;o<n;o+=r)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}function P(e,t,n){var r=t[0],i=t[1],o=n[0]-r,a=n[1]-i;if(0!==o||0!==a){var v=((e[0]-r)*o+(e[1]-i)*a)/(o*o+a*a);v>1?(r=n[0],i=n[1]):v>0&&(r+=o*v,i+=a*v)}return(o=e[0]-r)*o+(a=e[1]-i)*a}function F(e,t,n,r,i){for(var o,a=r,v=t+1;v<n;v++){var u=P(e[v],e[t],e[n]);u>a&&(o=v,a=u)}a>r&&(o-t>1&&F(e,t,o,r,i),i.push(e[o]),n-o>1&&F(e,o,n,r,i))}function B(e,t){var n=e.length-1,r=[e[0]];return F(e,0,n,t,r),r.push(e[n]),r}function U(e,t,n){if(e.length<=2)return e;var r=void 0!==t?t*t:1;return e=B(e=n?e:function(e,t){for(var n,r,i,o,a,v=e[0],u=[v],h=1,l=e.length;h<l;h++)n=e[h],i=v,o=void 0,a=void 0,o=(r=n)[0]-i[0],a=r[1]-i[1],o*o+a*a>t&&(u.push(n),v=n);return v!==n&&u.push(n),u}(e,r),r)}function V(e,t){return e[0]*t[0]+e[1]*t[1]}function E(e,t){var n=t[0],r=t[1],i=Math.sqrt(n*n+r*r);return e[0]=n/i,e[1]=r/i,e}function I(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}function L(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function O(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function W(e,t){var n=t[0],r=t[1],i=t[2],o=Math.sqrt(n*n+r*r+i*i);return e[0]=n/o,e[1]=r/o,e[2]=i/o,e}function j(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],v=n[1],u=n[2];return e[0]=i*u-o*v,e[1]=o*a-r*u,e[2]=r*v-i*a,e}r.deviation=function(e,t,n,r){var i=t&&t.length,o=i?t[0]*n:e.length,a=Math.abs(q(e,0,o,n));if(i)for(var v=0,u=t.length;v<u;v++){var h=t[v]*n,l=v<u-1?t[v+1]*n:e.length;a-=Math.abs(q(e,h,l,n))}var x=0;for(v=0;v<r.length;v+=3){var f=r[v]*n,s=r[v+1]*n,c=r[v+2]*n;x+=Math.abs((e[f]-e[c])*(e[s+1]-e[f+1])-(e[f]-e[s])*(e[c+1]-e[f+1]))}return 0===a&&0===x?0:Math.abs((x-a)/a)},r.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++)for(var a=0;a<t;a++)n.vertices.push(e[i][o][a]);i>0&&(r+=e[i-1].length,n.holes.push(r))}return n},t.default=n;var H=[];function k(e,t,n,r){var i=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}(t,n),o=Math.acos(i)*r;return I(H,n,t,-i),function(e,t){var n=t[0],r=t[1],i=t[2],o=Math.sqrt(n*n+r*r+i*i);e[0]=n/o,e[1]=r/o,e[2]=i/o}(H,H),function(e,t,n){e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n}(e,t,Math.cos(o)),I(e,e,H,Math.sin(o)),e}function _(e,t,n){if(n-t<3)return 0;for(var r=0,i=2*(n-1),o=2*t;o<2*n;){var a=e[i],v=e[i+1],u=e[o],h=e[o+1];i=o,o+=2,r+=a*h-u*v}return r}function D(e,n,r){return void 0===r&&(r=2),t(e,n,r)}var C=[],G=[],J=[];function K(e,t,n,r,i,o,a,v){var u=null!=a,h=i,l=null;u&&(l=new Uint32Array(r-n));for(var x=n;x<r;x++){var f=x===r-1?n:x+1,s=x===n?r-1:x-1,c=e[2*s],p=e[2*s+1],g=e[2*x],d=e[2*x+1],y=e[2*f],m=e[2*f+1];if(C[0]=g-c,C[1]=d-p,G[0]=y-g,G[1]=m-d,E(C,C),E(G,G),u&&(l[x]=h),v||x!==n)if(v||x!==r-1){L(J,G,C);var M=J[1];J[1]=-J[0],J[0]=M,E(J,J);var b=V(J,G),w=Math.sqrt(1-b*b),Z=o*Math.min(10,1/w);if(u&&1/w>a&&o*b<0){var S=g+J[0]*o,z=d+J[1]*o,A=Math.acos(w)/2,R=Math.tan(A)*Math.abs(o);t[2*h]=S+J[1]*R,t[2*h+1]=z-J[0]*R,t[2*++h]=S-J[1]*R,t[2*h+1]=z+J[0]*R,h++}else t[2*h]=g+J[0]*Z,t[2*h+1]=d+J[1]*Z,h++}else J[0]=C[1],J[1]=-C[0],E(J,J),t[2*h]=g+J[0]*o,t[2*h+1]=d+J[1]*o,h++;else J[0]=G[1],J[1]=-G[0],E(J,J),t[2*h]=g+J[0]*o,t[2*h+1]=d+J[1]*o,h++}return l}function N(e,t,n,r,i){var o=null!=r?[]:new Float32Array(e.length);if(K(e,o,0,t&&t.length?t[0]:e.length/2,0,n,r,i),t)for(var a=0;a<t.length;a++){var v=t[a];K(e,o,v,t[a+1]||e.length/2,null!=r?o.length/2:v,n,r,i)}return o}function Q(e,t,n,r){for(var i=0;i<Math.floor((r-n)/2);i++)for(var o=0;o<t;o++){var a=(i+n)*t+o,v=(r-i-1)*t+o,u=e[a];e[a]=e[v],e[v]=u}return e}function T(e,t){var n=e.length/2,r=0,i=t&&t.length?t[0]:n;_(e,r,i)>0&&Q(e,2,r,i);for(var o=1;o<(t?t.length:0)+1;o++)_(e,r=t[o-1],i=t[o]||n)<0&&Q(e,2,r,i)}function X(e){e.depth=e.depth||1,e.bevelSize=e.bevelSize||0,e.bevelSegments=null==e.bevelSegments?2:e.bevelSegments,e.smoothSide=e.smoothSide||!1,e.smoothBevel=e.smoothBevel||!1,e.simplify=e.simplify||0,"number"==typeof e.depth&&(e.bevelSize=Math.min(e.bevelSegments>0?e.bevelSize:0,e.depth/2)),e.bevelSize>0||(e.bevelSegments=0),e.bevelSegments=Math.round(e.bevelSegments);var t=e.boundingRect;if(e.translate=e.translate||[0,0],e.scale=e.scale||[1,1],e.fitRect){var n=null==e.fitRect.x?t.x||0:e.fitRect.x,r=null==e.fitRect.y?t.y||0:e.fitRect.y,i=e.fitRect.width,o=e.fitRect.height;null==i?null!=o?i=o/t.height*t.width:(i=t.width,o=t.height):null==o&&(o=i/t.width*t.height),e.scale=[i/t.width,o/t.height],e.translate=[(n-t.x)*e.scale[0],(r-t.y)*e.scale[1]]}}var Y=[[0,0],[1,0],[1,1],[0,0],[1,1],[0,1]];function $(e,t,n){for(var r=0,i=e[t],o=e[t+1],a=i,v=o,u=t+2;u<n;u+=2){var h=e[u],l=e[u+1];r+=Math.sqrt((h-i)*(h-i)+(l-o)*(l-o)),i=h,o=l}return r+=Math.sqrt((i-a)*(i-a)+(o-v)*(o-v))}function ee(e,t,n,r,i,o){var a=t.vertices,v=t.topVertices,u=t.depth,h=t.rect,l=r-n,x=o.smoothSide?1:2,f=l*x,s=o.smoothBevel?1:2,c=Math.min(u/2,o.bevelSize),p=o.bevelSegments,g=i.vertex,d=i.ringPerimeter,y=Math.max(h.width,h.height,u,d);if(c>0)for(var m=[0,0,1],M=[],b=[0,0,-1],w=[],Z=0,S=new Float32Array(l),z=0;z<2;z++)for(var A=0===z?u-c:c,R=0;R<=p*s;R++){for(var q=0,P=void 0,F=void 0,B=0;B<l;B++){for(var U=0;U<x;U++){var V=2*((B+U)%l+n);M[0]=a[V]-v[V],M[1]=a[V+1]-v[V+1],M[2]=0;var E=Math.sqrt(M[0]*M[0]+M[1]*M[1]);M[0]/=E,M[1]/=E;var I=(Math.floor(R/s)+R%s)/p;0===z?k(w,m,M,I):k(w,M,b,I);var L=0===z?I:1-I,O=c*Math.sin(L*Math.PI/2),W=E*Math.cos(L*Math.PI/2),j=c*E/Math.sqrt(O*O+W*W),H=w[0]*j+v[V],_=w[1]*j+v[V+1],D=w[2]*j+A;if(e.position[3*i.vertex]=H,e.position[3*i.vertex+1]=_,e.position[3*i.vertex+2]=D,(B>0||U>0)&&(q+=Math.sqrt((P-H)*(P-H)+(F-_)*(F-_))),R>0||z>0){var C=3*(i.vertex-f),G=e.position[C],J=e.position[C+1],K=e.position[C+2];S[B]+=Math.sqrt((G-H)*(G-H)+(J-_)*(J-_)+(K-D)*(K-D))}e.uv[2*i.vertex]=q/y,e.uv[2*i.vertex+1]=S[B]/y,P=H,F=_,i.vertex++}if(s>1&&R%s||1===s&&R>=1)for(var N=0;N<6;N++){var Q=(Y[N][0]+B*x)%f,T=Y[N][1]+Z;e.indices[i.index++]=(T-1)*f+Q+g}}Z++}else for(var X=0;X<2;X++)for(var $=0===X?u-c:c,ee=0,te=void 0,ne=void 0,re=0;re<l;re++)for(var ie=0;ie<x;ie++){var oe=2*((re+ie)%l+n),ae=a[oe],ve=a[oe+1];e.position[3*i.vertex]=ae,e.position[3*i.vertex+1]=ve,e.position[3*i.vertex+2]=$,(re>0||ie>0)&&(ee+=Math.sqrt((te-ae)*(te-ae)+(ne-ve)*(ne-ve))),e.uv[2*i.vertex]=ee/y,e.uv[2*i.vertex+1]=$/y,te=ae,ne=ve,i.vertex++}for(var ue=c>0?p*s+1:1,he=0;he<l;he++)for(var le=0;le<6;le++){var xe=(Y[le][0]+he*x)%f,fe=Y[le][1]+ue;e.indices[i.index++]=(fe-1)*f+xe+g}}function te(e,t,n,r){var i=e.indices,o=e.vertices,a=e.topVertices,v=e.rect,u=e.depth;if(!(o.length<=4)){for(var h=n.vertex,l=i.length,x=0;x<l;x++)t.indices[n.index++]=h+i[x];for(var f=Math.max(v.width,v.height),s=0;s<(r.excludeBottom?1:2);s++)for(var c=0;c<a.length;c+=2){var p=a[c],g=a[c+1];t.position[3*n.vertex]=p,t.position[3*n.vertex+1]=g,t.position[3*n.vertex+2]=(1-s)*u,t.uv[2*n.vertex]=(p-v.x)/f,t.uv[2*n.vertex+1]=(g-v.y)/f,n.vertex++}if(!r.excludeBottom)for(var d=o.length/2,y=0;y<l;y+=3)for(var m=0;m<3;m++)t.indices[n.index++]=h+d+i[y+2-m]}}function ne(e,t){for(var n=0,r=0,i=0;i<e.length;i++){var o=e[i],a=o.indices,v=o.vertices,u=o.holes,h=o.depth,l=v.length/2,x=Math.min(h/2,t.bevelSize)>0?t.bevelSegments:0;n+=a.length*(t.excludeBottom?1:2),r+=l*(t.excludeBottom?1:2);for(var f=2+2*x,s=0,c=0,p=0;p<(u?u.length:0)+1;p++){0===p?c=u&&u.length?u[0]:l:(s=u[p-1],c=u[p]||l),n+=6*(c-s)*(f-1);var g=(c-s)*(t.smoothSide?1:2);r+=g*f+(t.smoothBevel?0:x*g*2)}}for(var d={position:new Float32Array(3*r),indices:new(r>65535?Uint32Array:Uint16Array)(n),uv:new Float32Array(2*r)},y={vertex:0,index:0,ringPerimeter:0},m=0;m<e.length;m++)te(e[m],d,y,t);for(var M=0;M<e.length;M++){var b=e[M],w=b.holes,Z=b.vertices.length/2,S=0,z=w&&w.length?w[0]:Z;if(y.ringPerimeter=$(e[M].topVertices,S,z),ee(d,e[M],S,z,y,t),w)for(var A=0;A<w.length;A++)S=w[A],z=w[A+1]||Z,y.ringPerimeter=$(e[M].topVertices,S,z),ee(d,e[M],S,z,y,t)}for(var R=0;R<d.uv.length;R++){var q=d.uv[R];q>0&&Math.round(q)===q?d.uv[R]=1:d.uv[R]=q%1}return d.normal=function(e,t){function n(e,t,n,r){e[0]=t,e[1]=n,e[2]=r}for(var r=[],i=[],o=[],a=[],v=[],u=[],h=e.length,l=new Float32Array(t.length),x=0;x<h;){var f=3*e[x++],s=3*e[x++],c=3*e[x++];n(r,t[f],t[f+1],t[f+2]),n(i,t[s],t[s+1],t[s+2]),n(o,t[c],t[c+1],t[c+2]),O(a,r,i),O(v,i,o),j(u,a,v);for(var p=0;p<3;p++)l[f+p]=l[f+p]+u[p],l[s+p]=l[s+p]+u[p],l[c+p]=l[c+p]+u[p]}for(var g=0;g<l.length;)n(u,l[g],l[g+1],l[g+2]),W(u,u),l[g++]=u[0],l[g++]=u[1],l[g++]=u[2];return l}(d.indices,d.position),d.boundingRect=e[0]&&e[0].rect,d}function re(e,t,n){for(var r=n.lineWidth,i=e.length,o=new Float32Array(2*i),a=n.translate||[0,0],v=n.scale||[1,1],u=0,h=0;u<i;u++)o[h++]=e[u][0]*v[0]+a[0],o[h++]=e[u][1]*v[1]+a[1];_(o,0,i)<0&&Q(o,2,0,i);var l=[],x=[],f=n.miterLimit,s=K(o,x,0,i,0,-r/2,f,!1);Q(o,2,0,i);for(var c=K(o,l,0,i,0,-r/2,f,!1),p=(l.length+x.length)/2,g=new Float32Array(2*p),d=0,y=x.length/2,m=0;m<x.length;m++)g[d++]=x[m];for(var M=0;M<l.length;M++)g[d++]=l[M];for(var b=new(p>65535?Uint32Array:Uint16Array)(3*(2*(i-1)+(p-2*i))),w=0,Z=0;Z<i-1;Z++){var S=Z+1;b[w++]=y-1-s[Z],b[w++]=y-1-s[Z]-1,b[w++]=c[Z]+1+y,b[w++]=y-1-s[Z],b[w++]=c[Z]+1+y,b[w++]=c[Z]+y,c[S]-c[Z]==2?(b[w++]=c[Z]+2+y,b[w++]=c[Z]+1+y,b[w++]=y-s[S]-1):s[S]-s[Z]==2&&(b[w++]=c[S]+y,b[w++]=y-1-(s[Z]+1),b[w++]=y-1-(s[Z]+2))}var z=n.bevelSize>0?N(g,[],n.bevelSize,null,!0):g,A=n.boundingRect;return{vertices:g,indices:b,topVertices:z,rect:{x:A.x*v[0]+a[0],y:A.y*v[1]+a[1],width:A.width*v[0],height:A.height*v[1]},depth:"function"==typeof n.depth?n.depth(t):n.depth,holes:[]}}function ie(e,t){for(var n=[],r=0;r<e.length;r++){for(var i=e[r],o=[],a=i.length,v=i[a-1][0],u=i[a-1][1],h=0,l=0;l<a;l++){var x=i[l][0],f=i[l][1],s=x-v,c=f-u;(h+=Math.sqrt(s*s+c*c))>t&&(o.push(i[l]),h=0),v=x,u=f}o.length>=3&&n.push(o)}return n.length>0?n:null}function oe(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r];(i=U(i,t,!0)).length>=3&&n.push(i)}return n.length>0?n:null}function ae(e,t,n){for(var r=0;r<e.length;r++)t[0]=Math.min(e[r][0],t[0]),t[1]=Math.min(e[r][1],t[1]),n[0]=Math.max(e[r][0],n[0]),n[1]=Math.max(e[r][1],n[1])}var ve={x:0,y:0},ue={x:0,y:0};function he(e,t,n,r){for(var i=e.length,o=0;o<i;o++){var a=e[o].data;t=e[o].center||t;for(var v=0,u=a.length;v<u;v++)for(var h=a[v],l=0,x=h.length;l<x;l++)e[o].data[v][l]=le(h[l],t,n,r)}}function le(e,t,n,r){for(var i=new Float32Array(e),o=[],a=0,v=i.length;a<v;a+=2){var u=i[a],h=i[a+1];if(t&&n&&r){ve.x=u,ve.y=h;var l=ye(ve,ue);ve.x=l.x,ve.y=l.y,u=(l=me(r,ve,n,ue)).x,h=l.y,u-=t[0],h-=t[1]}o.push([u,h])}return o}function xe(e,t){void 0===t&&(t=!1);for(var n=e.length,r=[],i=[],o=[],a=0,v=0,u=0,h=0,l=0;l<n;l++){var x=t?se(e[l]):fe(e[l]),f=e[l].bottomHeight||0,s=x.position,c=x.normal,p=x.uv,g=x.indices;i.push(x);var d=g.length/3;o[l]=[a+1,a+d],a+=d;var y=s.length/3,m=c.length/3,M=p.length/2;r[l]={position:{middleZ:f+(e[l].height||0)/2,count:y,start:v,end:v+3*y},normal:{count:m,start:u,end:u+3*m},uv:{count:M,start:h,end:h+2*M},hide:!1},v+=3*y,u+=3*m,h+=2*M}var b=function(e){for(var t={},n={},r=0;r<e.length;++r){var i=e[r];for(var o in i)void 0===t[o]&&(t[o]=[],n[o]=0),t[o].push(i[o]),n[o]+=i[o].length}var a={},v=0,u=[];for(var h in t)if("indices"===h)for(var l=t[h],x=0,f=l.length;x<f;x++){for(var s=l[x],c=0,p=s.length;c<p;c++)u.push(s[c]+v);v+=t.position[x].length/3}else{var g=ce(t[h],n[h]);if(!g)return null;a[h]=g}return a.indices=new Uint32Array(u),a}(i),w=b.position,Z=b.normal,S=b.uv,z=b.indices;return{position:w.buffer,normal:Z.buffer,uv:S.buffer,indices:z.buffer,faceMap:o,geometriesAttributes:r}}function fe(e){var n=e.data,r=e.height,i=e.bottomHeight,o=function(e,n){n=Object.assign({},n);for(var r=[1/0,1/0],i=[-1/0,-1/0],o=0;o<e.length;o++)ae(e[o][0],r,i);n.boundingRect=n.boundingRect||{x:r[0],y:r[1],width:i[0]-r[0],height:i[1]-r[1]},X(n);for(var a=[],v=n.translate||[0,0],u=n.scale||[1,1],h=n.boundingRect,l={x:h.x*u[0]+v[0],y:h.y*u[1]+v[1],width:h.width*u[0],height:h.height*u[1]},x=Math.min(h.width,h.height)/1e5,f=0;f<e.length;f++){var s=ie(e[f],x);if(s){var c=n.simplify/Math.max(u[0],u[1]);if(c>0&&(s=oe(s,c)),s){for(var p=t.flatten(s),g=p.vertices,d=p.holes,y=p.dimensions,m=0;m<g.length;)g[m]=g[m++]*u[0]+v[0],g[m]=g[m++]*u[1]+v[1];if(T(g,d),2!==y)throw new Error("Only 2D polygon points are supported");var M=n.bevelSize>0?N(g,d,n.bevelSize,null,!0):g,b=D(M,d,y);a.push({indices:b,vertices:g,topVertices:M,holes:d,rect:l,depth:"function"==typeof n.depth?n.depth(f):n.depth})}}}return ne(a,n)}(n,{depth:r}),a=o.position,v=o.normal,u=o.uv,h=o.indices;return pe(a,i),{position:a,normal:v,uv:u,indices:h}}function se(e){var t=e.data,n=e.height,r=e.width,i=e.bottomHeight,o=function(e,t){t=Object.assign({},t);for(var n=[1/0,1/0],r=[-1/0,-1/0],i=0;i<e.length;i++)ae(e[i],n,r);t.boundingRect=t.boundingRect||{x:n[0],y:n[1],width:r[0]-n[0],height:r[1]-n[1]},X(t);var o=t.scale||[1,1];null==t.lineWidth&&(t.lineWidth=1),null==t.miterLimit&&(t.miterLimit=2);for(var a=[],v=0;v<e.length;v++){var u=e[v],h=t.simplify/Math.max(o[0],o[1]);h>0&&(u=U(u,h,!0)),a.push(re(u,v,t))}return ne(a,t)}(t,{lineWidth:r,depth:n}),a=o.position,v=o.normal,u=o.uv,h=o.indices;return pe(a,i),{position:a,normal:v,uv:u,indices:h}}function ce(e,t){for(var n=new Float32Array(t),r=0,i=0;i<e.length;++i)n.set(e[i],r),r+=e[i].length;return n}function pe(e,t){if(void 0!==t&&"number"==typeof t&&0!==t)for(var n=0,r=e.length;n<r;n+=3)e[n+2]+=t}var ge=Math.PI/180,de=6378137*Math.PI/180;function ye(e,t){var n,r=85.0511287798,i=e.x,o=Math.max(Math.min(r,e.y),-r);n=0===o?0:Math.log(Math.tan((90+o)*ge/2))/ge;var a=i*de,v=n*de;return t?(t.x=a,t.y=v,t):{x:a,y:v}}function me(e,t,n,r){var i=e[0]*(t.x-e[2])/n,o=-e[1]*(t.y-e[3])/n;return r?(r.x=i,r.y=o,r):{x:i,y:o}}e.initialize=function(){},e.onmessage=function(e,t){var n=e.data,r=n.type,i=n.datas,o=n.glRes,a=n.matrix,v=n.center;if("ExtrudePolygons"===r){he(i,v,o,a);var u=xe(i);t(null,u,[u.position,u.normal,u.uv,u.indices])}else if("ExtrudeLines"===r){for(var h=0,l=i.length;h<l;h++)for(var x=0,f=i[h].data.length;x<f;x++)i[h].data[x]=le(i[h].data[x]);var s=xe(i,!0);t(null,s,[s.position,s.normal,s.uv,s.indices])}else if("ExtrudePolygon"===r){var c=[],p=[];i.forEach((function(e){var t=[e];he(t,v,o,a);var n=xe(t),r=n.position,i=n.normal,u=n.uv,h=n.indices;c.push({id:e.id,position:r,normal:i,uv:u,indices:h}),p.push(r,i,u,h)})),t(null,c,p)}},Object.defineProperty(e,"__esModule",{value:!0})})`;
const workerName = '__maptalks.three__';

export function getWorkerName() {
    return workerName;
}

export function getWorkerCode() {
    return workerCode;
}
